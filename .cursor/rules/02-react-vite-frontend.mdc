---
description: 'Complete React, Vite, and TailwindCSS frontend development guide'
globs:
  [
    'apps/frontend/**/*.js',
    'apps/frontend/**/*.jsx',
    'apps/frontend/**/*.ts',
    'apps/frontend/**/*.tsx',
  ]
alwaysApply: false
version: '1.0.0'
lastUpdated: '2025-11-18'
---

# React + Vite Frontend Best Practices

You are an expert in React, JavaScript, Vite, TailwindCSS, and modern frontend development.

## Core Principles

- Write concise, technical responses with accurate React examples
- Use functional components with hooks
- Prefer composition over inheritance
- Use declarative JSX
- Follow single responsibility principle
- Write testable, modular code

## JavaScript/React Standards

### Function Components

- Use arrow functions for components
- Use named exports (not default exports)
- Use hooks for state management
- Keep components small and focused
- Extract complex logic into custom hooks

### File Structure

```
components/
  ├── ComponentName.jsx          # Component implementation
  └── ComponentName.css          # Component-specific styles (if needed)
hooks/
  └── useCustomHook.js           # Custom hooks
services/
  └── apiService.js              # API client
stores/
  └── useStore.js                # Zustand stores
```

### Naming Conventions

- Components: `PascalCase.jsx`
- Functions/Hooks: `camelCase`
- Constants: `UPPER_SNAKE_CASE`
- CSS files: `PascalCase.css`

## Error Handling

**Always implement error boundaries and loading states:**

```javascript
export const ShipmentForm = () => {
  const [shipment, setShipment] = useState(null);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState('');

  const handleSubmit = async (formData) => {
    setLoading(true);
    setError('');

    try {
      const result = await api.createShipment(formData);
      setShipment(result.data);
    } catch (err) {
      setError(err.message || 'Failed to create shipment');
      console.error('Shipment creation error:', err);
    } finally {
      setLoading(false);
    }
  };

  if (error) {
    return <ErrorMessage message={error} />;
  }

  if (loading) {
    return <LoadingSpinner />;
  }

  return <form onSubmit={handleSubmit}>{/* Form fields */}</form>;
};
```

## State Management

### Local State (useState)

Use for component-specific state:

```javascript
const [isOpen, setIsOpen] = useState(false);
const [formData, setFormData] = useState({});
```

### Global State (Zustand)

Use for app-wide state:

```javascript
import { create } from 'zustand';

export const useShipmentStore = create((set) => ({
  shipments: [],
  addShipment: (shipment) => set((state) => ({ shipments: [...state.shipments, shipment] })),
  clearShipments: () => set({ shipments: [] }),
}));
```

### Server State (Custom Hook + API)

Use for data fetching:

```javascript
export const useShipments = () => {
  const [data, setData] = useState(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);

  useEffect(() => {
    const fetchShipments = async () => {
      try {
        const result = await api.getShipments();
        setData(result.data);
      } catch (err) {
        setError(err);
      } finally {
        setLoading(false);
      }
    };

    fetchShipments();
  }, []);

  return { data, loading, error };
};
```

## API Integration

### Centralized API Service

```javascript
// services/api.js
const API_BASE_URL = import.meta.env.VITE_API_URL || 'http://localhost:8000';

class ApiError extends Error {
  constructor(message, status, data) {
    super(message);
    this.status = status;
    this.data = data;
  }
}

const handleResponse = async (response) => {
  if (!response.ok) {
    const error = await response.json().catch(() => ({}));
    throw new ApiError(error.message || 'Request failed', response.status, error);
  }
  return response.json();
};

export const api = {
  async createShipment(data) {
    const response = await fetch(`${API_BASE_URL}/api/v1/shipments`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(data),
    });
    return handleResponse(response);
  },

  async getShipments(params = {}) {
    const query = new URLSearchParams(params).toString();
    const response = await fetch(`${API_BASE_URL}/api/v1/shipments?${query}`);
    return handleResponse(response);
  },

  async trackShipment(trackingNumber) {
    const response = await fetch(`${API_BASE_URL}/api/v1/tracking/${trackingNumber}`);
    return handleResponse(response);
  },
};
```

## Performance Optimization

### Code Splitting

```javascript
import { lazy, Suspense } from 'react';

const Dashboard = lazy(() => import('./pages/DashboardPage'));
const ShipmentDetails = lazy(() => import('./pages/ShipmentDetailsPage'));

export const App = () => (
  <Suspense fallback={<LoadingSpinner />}>
    <Router>
      <Routes>
        <Route path="/" element={<Dashboard />} />
        <Route path="/shipments/:id" element={<ShipmentDetails />} />
      </Routes>
    </Router>
  </Suspense>
);
```

### Memoization

```javascript
import { useMemo, useCallback } from 'react';

export const ShipmentList = ({ shipments }) => {
  // Memoize expensive computations
  const sortedShipments = useMemo(() => {
    return [...shipments].sort((a, b) => new Date(b.created_at) - new Date(a.created_at));
  }, [shipments]);

  // Memoize callbacks
  const handleDelete = useCallback((id) => {
    console.log('Deleting', id);
  }, []);

  return (
    <div>
      {sortedShipments.map((shipment) => (
        <ShipmentCard key={shipment.id} shipment={shipment} onDelete={handleDelete} />
      ))}
    </div>
  );
};
```

### Debouncing & Throttling

```javascript
import { useState, useEffect } from 'react';

export const useDebounce = (value, delay = 500) => {
  const [debouncedValue, setDebouncedValue] = useState(value);

  useEffect(() => {
    const handler = setTimeout(() => {
      setDebouncedValue(value);
    }, delay);

    return () => clearTimeout(handler);
  }, [value, delay]);

  return debouncedValue;
};

// Usage
const SearchBar = () => {
  const [search, setSearch] = useState('');
  const debouncedSearch = useDebounce(search, 300);

  useEffect(() => {
    if (debouncedSearch) {
      // Make API call
      api.searchShipments(debouncedSearch);
    }
  }, [debouncedSearch]);

  return <input value={search} onChange={(e) => setSearch(e.target.value)} />;
};
```

## TailwindCSS Best Practices

### Component Styling

```javascript
export const Button = ({ variant = 'primary', children, ...props }) => {
  const baseClasses = 'px-4 py-2 rounded-lg font-medium transition-colors';
  const variants = {
    primary: 'bg-blue-600 text-white hover:bg-blue-700',
    secondary: 'bg-gray-200 text-gray-800 hover:bg-gray-300',
    danger: 'bg-red-600 text-white hover:bg-red-700',
  };

  return (
    <button className={`${baseClasses} ${variants[variant]}`} {...props}>
      {children}
    </button>
  );
};
```

### Responsive Design

```javascript
<div
  className="
  grid
  grid-cols-1
  md:grid-cols-2
  lg:grid-cols-3
  gap-4
  p-4
"
>
  {/* Cards */}
</div>
```

## Form Handling

```javascript
export const ShipmentForm = ({ onSubmit }) => {
  const [formData, setFormData] = useState({
    to_address: '',
    from_address: '',
    parcel: '',
  });

  const handleChange = (e) => {
    const { name, value } = e.target;
    setFormData((prev) => ({ ...prev, [name]: value }));
  };

  const handleSubmit = async (e) => {
    e.preventDefault();
    await onSubmit(formData);
  };

  return (
    <form onSubmit={handleSubmit} className="space-y-4">
      <input
        name="to_address"
        value={formData.to_address}
        onChange={handleChange}
        className="w-full px-4 py-2 border rounded-lg"
        placeholder="To Address"
      />
      {/* More fields */}
      <button type="submit" className="btn-primary">
        Create Shipment
      </button>
    </form>
  );
};
```

## Testing

```javascript
import { render, screen, fireEvent, waitFor } from '@testing-library/react';
import { describe, it, expect, vi } from 'vitest';
import { ShipmentForm } from './ShipmentForm';

describe('ShipmentForm', () => {
  it('submits form data', async () => {
    const onSubmit = vi.fn();
    render(<ShipmentForm onSubmit={onSubmit} />);

    fireEvent.change(screen.getByPlaceholderText('To Address'), {
      target: { value: '123 Main St' },
    });

    fireEvent.click(screen.getByText('Create Shipment'));

    await waitFor(() => {
      expect(onSubmit).toHaveBeenCalledWith({
        to_address: '123 Main St',
        from_address: '',
        parcel: '',
      });
    });
  });
});
```

## Vite Configuration

```javascript
// vite.config.js
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';

export default defineConfig({
  plugins: [react()],
  server: {
    port: 3000,
    proxy: {
      '/api': {
        target: 'http://localhost:8000',
        changeOrigin: true,
      },
    },
  },
  build: {
    outDir: 'dist',
    sourcemap: true,
    rollupOptions: {
      output: {
        manualChunks: {
          vendor: ['react', 'react-dom', 'react-router-dom'],
        },
      },
    },
  },
});
```

## Environment Variables

```javascript
// .env.development
VITE_API_URL=http://localhost:8000
VITE_EASYPOST_PUBLIC_KEY=pk_test_...

// Usage in code
const API_URL = import.meta.env.VITE_API_URL;
```

## Accessibility

```javascript
export const Modal = ({ isOpen, onClose, title, children }) => {
  return (
    <div
      role="dialog"
      aria-modal="true"
      aria-labelledby="modal-title"
      className={isOpen ? 'block' : 'hidden'}
    >
      <div className="modal-overlay" onClick={onClose} />
      <div className="modal-content">
        <h2 id="modal-title">{title}</h2>
        {children}
        <button onClick={onClose} aria-label="Close modal">
          ×
        </button>
      </div>
    </div>
  );
};
```

## Key Conventions

1. **Component Organisation**: One component per file
2. **Props Validation**: Use PropTypes or TypeScript
3. **Error Boundaries**: Wrap app sections in error boundaries
4. **Loading States**: Always show loading indicators
5. **Error Messages**: User-friendly error messages
6. **Accessibility**: Use semantic HTML and ARIA attributes
7. **Performance**: Code split, lazy load, memoize

---

Refer to React, Vite, and TailwindCSS documentation for best practices.
